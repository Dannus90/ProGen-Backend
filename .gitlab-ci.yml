services:
  - postgres:latest

variables:
  POSTGRES_DB: progenlocal
  POSTGRES_USER: progen
  POSTGRES_PASSWORD: progen
  POSTGRES_HOST_AUTH_METHOD: trust

default:
  image: ubuntu:latest

  before_script:
    - apt-get update
    - -i -u postgres
    - psql

stages:
  - build
  - ci-test

build:
  stage: build
  script:
    - cat /etc/issue
    - psql --version
  variables:
    build_path: "$project"

test:
  stage: ci-test
  image: ubuntu:latest
  variables:
    test_path: "$project"
  script:
    - "dotnet test"

