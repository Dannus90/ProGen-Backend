default: 
  image: ubuntu:latest
  
  services: 
    - postgres:13.2-alpine
      
    variables:
      POSTGRES_DB: progenlocal
      POSTGRES_USER: progen
      POSTGRES_PASSWORD: progenm
      POSTGRES_HOST_AUTH_METHOD: trust√ü

  before_script:
    - apt-get update
    - apt install --yes --force-yes postgresql postgresql-contrib
    - -i -u postgres
    - psql

stages:
  - build
  - ci-test

build:
  stage: build
  script:
    - cat /etc/issue
    - psql --version
  variables:
    build_path: "$project"

test:
  stage: ci-test
  image: ubuntu:latest
  variables:
    test_path: "$project"
  script:
    - "dotnet test"
